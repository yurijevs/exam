{"config":{"lang":["ru","en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u041f\u0440\u043e\u0441\u0442\u043e \u0441\u0434\u0430\u044e \u044d\u043a\u0437\u0430\u043c\u0435\u043d","text":""},{"location":"#-","title":"\u041f\u043e\u0442\u043e\u043c \u0432\u0441\u0451 \u0443\u0434\u0430\u043b\u044e \ud83d\ude05. \u0427\u0435\u0441\u0442\u043d\u043e-\u0447\u0435\u0441\u0442\u043d\u043e.","text":"<p>\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u043b \u043f\u0435\u0440\u0435\u0435\u0445\u0430\u0442\u044c \u043d\u0430 Github Pages. \u0414\u0430\u0436\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c.</p>"},{"location":"ticket_01/","title":"\u0411\u0438\u043b\u0435\u0442 01.  HTTPS \u0441 \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c \u0438  \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0442\u0440\u0430\u0444\u0438\u043a\u0430","text":""},{"location":"ticket_01/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0412\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440 - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_01/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0432\u0435\u0431-\u0441\u0430\u0439\u0442 \u0441 \u0430\u0434\u0440\u0435\u0441\u043e\u043c https://www.mydomain.ru</li> <li>\u043f\u043e \u043c\u0435\u043d\u044c\u0448\u0435\u0439 \u043c\u0435\u0440\u0435 \u0441 \u043e\u0434\u043d\u043e\u0439 \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 Web-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435\u0439 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u044f</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>web-\u0441\u0430\u0439\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0432\u0435\u0431-\u0441\u0430\u0439\u0442\u0443, \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0443 SSH</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u044e\u0442 \u043b\u044e\u0431\u044b\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043a\u0440\u043e\u043c\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445</li> </ul> </li> </ul>"},{"location":"ticket_01/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430<ul> <li>\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u043c \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0430\u0434\u0440\u0435\u0441\u0443 - \u0441\u0430\u0439\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0432\u043d\u0435\u0441\u0435\u043d\u0438\u044f \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439</li> <li>\u0443\u0442\u0438\u043b\u0438\u0442\u043e\u0439 nmap \u043a \u043b\u044e\u0431\u043e\u043c\u0443 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043f\u043e\u0440\u0442\u0443 - \u043f\u043e\u0440\u0442\u044b \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u0432, \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> </ul>"},{"location":"ticket_01/#altsrv1","title":"Altsrv1","text":"<pre><code>apt-get install nginx\nsystemctl enable --now nginx\napt-get install webserver-common\nmkdir /etc/nginx/ssl\ncd /etc/nginx/ssl\nopenssl req -newkey rsa:4096 -nodes -keyout site.key -x509 -days 365 -out site.crt\n...\nCommon Name (e.g., your name or your server's hostname) []:mydomain.ru\n...\ncd /etc/nginx/sites-available.d/\nvim mydomain.conf\nmkdir -p /var/www/vhosts/mydomain/{htdocs,logs}\necho \"&lt;html&gt;&lt;body&gt;&lt;h1&gt;&lt;b&gt;MYDOMAIN.RU&lt;b&gt;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\" &gt; /var/www/vhosts/mydomain/htdocs/index.html\ncd /etc/nginx/sites-enabled.d/\nln -s ../sites-available.d/mydomain.conf ./\nnginx -t\nsystemctl restart nginx\n</code></pre>"},{"location":"ticket_01/#mydomainconf","title":"mydomain.conf","text":"<pre><code>server {\n    listen 443 ssl;\n\n    server_name mydomain.ru;\n    ssl_certificate /etc/nginx/ssl/site.crt;\n    ssl_certificate_key /etc/nginx/ssl/site.key;\n    location / {\n        root /var/www/vhosts/mydomain/htdocs;\n    }\n    access_log /var/www/vhosts/mydomain/logs/access.log;\n    error_log /var/www/vhosts/mydomain/logs/error.log;\n}\nserver {\n    listen 80;\n    server_name mydomain.ru;\n    return 301 https://$server_name$request_uri;\n}\n</code></pre>"},{"location":"ticket_01/#iptablessh","title":"iptables.sh","text":"<pre><code>#!/bin/bash\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 loopback-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 DNS\niptables -A OUTPUT -p udp --dport 53 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -p tcp --dport 53 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A INPUT -p udp --sport 53 -m state --state ESTABLISHED -j ACCEPT\niptables -A INPUT -p tcp --sport 53 -m state --state ESTABLISHED -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 HTTP (\u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439)\niptables -A INPUT -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -p tcp --sport 80 -m state --state ESTABLISHED\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 HTTPS (\u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439)\niptables -A INPUT -p tcp --dport 443 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -p tcp --sport 443 -m state --state ESTABLISHED -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 SSH (\u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439)\niptables -A INPUT -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUTPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u041f\u041e (\u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439)\niptables -A OUTPUT -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A INPUT -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT\niptables -A OUTPUT -p tcp --dport 443 -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A INPUT -p tcp --sport 443 -m state --state ESTABLISHED -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\niptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# \u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\niptables -P INPUT DROP\niptables -P OUTPUT DROP\niptables -P FORWARD DROP\n</code></pre> <pre><code>iptables-save &gt; /etc/sysconfig/iptables\niptables-restore /etc/sysconfig/iptables\nsystemctl enable --now iptables\n</code></pre>"},{"location":"ticket_01/#altwks1","title":"Altwks1","text":"<pre><code>echo \"192.168.100.251 mydomain.ru www.mydomain.ru\" &gt;&gt; /etc/hosts\n</code></pre>"},{"location":"ticket_02/","title":"\u0411\u0438\u043b\u0435\u0442 02. HTTPS c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c \u043e\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0423\u0426","text":""},{"location":"ticket_02/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0412\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440, \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0438\u0439 \u0446\u0435\u043d\u0442\u0440 - \u0434\u0432\u0435 \u043b\u044e\u0431\u044b\u0435 \u0440\u0430\u0437\u043d\u044b\u0435 \u0412\u041c \u043d\u0430 \u0432\u0430\u0448 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_02/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0432\u0435\u0431-\u0441\u0430\u0439\u0442 \u0441 \u0430\u0434\u0440\u0435\u0441\u043e\u043c https://www.mydomain.ru</li> <li>\u043f\u043e \u043c\u0435\u043d\u044c\u0448\u0435\u0439 \u043c\u0435\u0440\u0435 \u0441 \u043e\u0434\u043d\u043e\u0439 \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 Web-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435\u0439 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u044f</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>web-\u0441\u0430\u0439\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442, \u0432\u044b\u0434\u0430\u043d\u043d\u044b\u0439 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u043c \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u043c \u0446\u0435\u043d\u0442\u0440\u043e\u043c</li> <li>\u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0431\u0430\u0437\u0443 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430</li> </ul> </li> </ul>"},{"location":"ticket_02/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438 \u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430<ul> <li>\u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u043c \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0430\u0434\u0440\u0435\u0441\u0443 - \u0441\u0430\u0439\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0442\u044c\u0441\u044f, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0437\u0430\u0449\u0438\u0449\u0435\u043d\u043d\u043e\u0435</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> </ul>"},{"location":"ticket_02/#altsrv2","title":"Altsrv2","text":"<pre><code>echo \"192.168.100.252 altsrv2\" &gt;&gt; /etc/hosts\napt-get install easy-rsa\nmkdir /srv/ca\ncd /srv/ca\neasyrsa init-pki\neasyrsa build-ca\n...\nEnter New CA Key Passphrase: # (1)\nRe-Enter New CA Key Passphrase: # (2)\n...\nCommon Name (eg: your user, host, or server name) [Easy-RSA CA]:altsrv2\n...\nvim mydomain.ru.req # (3)\neasyrsa import-req mydomain.ru.req mydomain.ru\ncat /srv/ca/pki/issued/mydomain.ru.crt # (4)\ncat pki/ca.crt # (5)\n</code></pre> <ol> <li>12345678</li> <li>12345678</li> <li>\u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 mydomain.ru.req c altsrv1 \u043d\u0430 \u043f\u043e\u0434\u043f\u0438\u0441\u044c</li> <li>\u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0438 \u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430 altsrv1</li> <li>\u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0438 \u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430 altsrv1</li> </ol>"},{"location":"ticket_02/#altsrv1","title":"Altsrv1","text":"<pre><code>apt-get install nginx webserver-common easy-rsa\nsystemctl enable --now nginx\nmkdir /srv/ca\ncd /srv/ca\neasyrsa init-pki\neasyrsa gen-req mydomain.ru nopass\ncat /srv/ca/pki/reqs/mydomain.ru.req # (1)\nvim pki/mydomain.ru.crt # (2)\nvim pki/ca.crt # (3)\n\ncd /etc/nginx/sites-available.d/\nvim mydomain.conf\nmkdir -p /var/www/vhosts/mydomain/{htdocs,logs}\necho \"&lt;html&gt;&lt;body&gt;&lt;h1&gt;&lt;b&gt;MYDOMAIN.RU&lt;b&gt;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\" &gt; /var/www/vhosts/mydomain/htdocs/index.html\ncd /etc/nginx/sites-enabled.d/\nln -s ../sites-available.d/mydomain.conf ./\nnginx -t\nsystemctl restart nginx\n</code></pre> <ol> <li>\u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438 \u0432\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043d\u0430 altsrv2</li> <li>\u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c mydomain.ru.crt \u0438\u0437 altsrv2</li> <li>\u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c ca.crt \u0438\u0437 altsrv2</li> </ol>"},{"location":"ticket_02/#mydomainconf","title":"mydomain.conf","text":"<pre><code>server {\n        listen 443 ssl;\n\n        server_name mydomain.ru;\n        ssl_certificate /srv/ca/pki/mydomain.ru.crt;\n        ssl_certificate_key /srv/ca/pki/private/mydomain.ru.key;\n        location / {\n                root /var/www/vhosts/mydomain/htdocs;\n        }\n        access_log /var/www/vhosts/mydomain/logs/access.log;\n        error_log /var/www/vhosts/mydomain/logs/error.log;\n}\nserver {\n        listen 80;\n        server_name mydomain.ru;\n        return 301 https://$server_name$request_uri;\n}\n</code></pre>"},{"location":"ticket_02/#altwks1","title":"Altwks1","text":"<pre><code>echo \"192.168.100.251 mydomain.ru www.mydomain.ru\" &gt;&gt; /etc/hosts\necho \"192.168.100.252 altsrv2\" &gt;&gt; /etc/hosts\n\nvim ~/ca.crt # (1)\n</code></pre> <ol> <li>\u0432\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 ca.crt \u0438\u0437 altsrv2 \u0432 \u0434\u043e\u043c.\u043f\u0430\u043f\u043a\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f sysadmin, \u0437\u0430\u0442\u0435\u043c \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432 \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435</li> </ol>"},{"location":"ticket_03/","title":"\u0411\u0438\u043b\u0435\u0442 03. SMB-\u0441\u0435\u0440\u0432\u0435\u0440 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 AD","text":""},{"location":"ticket_03/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 AD - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 (SMB) \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_03/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0434\u043e\u043c\u0435\u043d Active Directory \u0441 \u0438\u043c\u0435\u043d\u0435\u043c test.dom</li> <li>\u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b</li> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417: sambauser1 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>, sambauser2 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code></li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417 \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0443 SMB \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u043e\u043c\u0443 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443 smbshare \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430</li> <li>\u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443 sambashare \u043f\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c sambauser1 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435</li> <li>\u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443 sambashare \u043f\u043e\u0434 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c sambauser2 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u043d\u0430 \u0447\u0442\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044c</li> </ul> </li> </ul>"},{"location":"ticket_03/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0443 SMB \u043a \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u043e\u043c\u0443 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0443 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043f\u043e\u0434 \u043e\u0431\u043e\u0438\u043c\u0438 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0443\u0447\u0435\u0442\u043d\u044b\u043c\u0438 \u0437\u0430\u043f\u0438\u0441\u044f\u043c\u0438<ul> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0447\u0442\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u043e\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435</li> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433</li> </ul> </li> </ul>"},{"location":"ticket_03/#altsrv2","title":"Altsrv2","text":""},{"location":"ticket_03/#etchosts","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altsrv2.test.dom\napt-get install alterator-fbi\nsystemctl enable --now alteratord ahttpd\napt-get install alterator-net-domain task-samba-dc\napt-get install alterator-datetime # (1)\nsystemctl restart alteratord ahttpd\nsystemctl stop smb nmb krb5kdc slapd bind dnsmasq\nsystemctl disable smb nmb krb5kdc slapd bind dnsmasq\nrm -f /etc/samba/smb.conf\nrm -rf /var/lib/samba\nrm -rf /var/cache/samba\nmkdir -p /var/lib/samba/sysvol\nsamba-tool domain provision --realm=test.dom --domain test --adminpass='Pa$$word' --dns-backend=SAMBA_INTERNAL --server-role=dc --use-rfc2307\nsystemctl enable --now samba\ncp /var/lib/samba/private/krb5.conf /etc/krb5.conf\nsamba-tool user create sambauser1\nsamba-tool user create sambauser2\n</code></pre> <ol> <li>\u0447\u0435\u0440\u0435\u0437 web-gui, \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0430\u0447\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u0438</li> </ol>"},{"location":"ticket_03/#etcnetifacesens19resolvconf","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 127.0.0.1\n</code></pre>"},{"location":"ticket_03/#altsrv1","title":"Altsrv1","text":""},{"location":"ticket_03/#etchosts_1","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altsrv1.test.dom\nvim /etc/net/ifaces/ens19/resolv.conf\nreboot\n\n# (1)\napt-get install task-auth-ad-sssd\n</code></pre> <ol> <li>\u0432\u0432\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d</li> </ol> <p> <pre><code>apt-get install samba\nsystemctl enable --now smb\nsystemctl enable --now avahi-daemon\nmkdir /srv/smbshare\napt-get install acl\nsetfacl -m u:sambauser1:r-x /srv/smbshare\nsetfacl -m u:sambauser2:rwx /srv/smbshare\nvim /etc/samba/smb.conf\nsystemctl restart smb\n</code></pre></p>"},{"location":"ticket_03/#etcsambasmbconf","title":"/etc/samba/smb.conf","text":"<pre><code>...\n[smbshare]\n        path = /srv/smbshare\n        read only = no\n        valid users = sambauser1, sambauser2\n        force create mode = 0660\n        force directory mode = 0770\n        inherit acls = yes\n</code></pre>"},{"location":"ticket_03/#etcnetifacesens19resolvconf_1","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_03/#altwks1","title":"Altwks1","text":""},{"location":"ticket_03/#etchosts_2","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altwks1.test.dom\nvim /etc/net/ifaces/ens19/resolv.conf\nreboot\n\n# (1)\napt-get install task-auth-ad-sssd\n</code></pre> <ol> <li>\u0432\u0432\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d</li> </ol>"},{"location":"ticket_03/#etcnetifacesens19resolvconf_2","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_04/","title":"\u0411\u0438\u043b\u0435\u0442 04. \u041e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f AD","text":""},{"location":"ticket_04/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 AD - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0412\u0442\u043e\u0440\u043e\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 AD - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_04/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0434\u043e\u043c\u0435\u043d Active Directory \u0441 \u0438\u043c\u0435\u043d\u0435\u043c test.dom</li> <li>\u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430</li> <li>\u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b</li> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417: sambauser1 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>, sambauser2 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>,</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443</li> <li>\u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0435\u0441\u043b\u0438 \u043e\u0431\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b</li> <li>\u0432 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 (\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u044b\u0439) \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d</li> </ul> </li> </ul>"},{"location":"ticket_04/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043f\u043e\u0434 \u043e\u0431\u043e\u0438\u043c\u0438 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0443\u0447\u0435\u0442\u043d\u044b\u043c\u0438 \u0437\u0430\u043f\u0438\u0441\u044f\u043c\u0438<ul> <li>\u0432\u0445\u043e\u0434 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u043c \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430</li> <li>\u0432\u0445\u043e\u0434 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u043c \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430</li> </ul> </li> </ul>"},{"location":"ticket_04/#altsrv2","title":"Altsrv2","text":""},{"location":"ticket_04/#etchosts","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altsrv2.test.dom\napt-get install alterator-fbi\nsystemctl enable --now alteratord ahttpd\napt-get install alterator-net-domain task-samba-dc\napt-get install alterator-datetime # (1)\nsystemctl restart alteratord ahttpd\nsystemctl stop smb nmb krb5kdc slapd bind dnsmasq\nsystemctl disable smb nmb krb5kdc slapd bind dnsmasq\nrm -f /etc/samba/smb.conf\nrm -rf /var/lib/samba\nrm -rf /var/cache/samba\nmkdir -p /var/lib/samba/sysvol\nsamba-tool domain provision --realm=test.dom --domain test --adminpass='Pa$$word' --dns-backend=SAMBA_INTERNAL --server-role=dc --use-rfc2307\nsystemctl enable --now samba\ncp /var/lib/samba/private/krb5.conf /etc/krb5.conf\nsamba-tool dns add 127.0.0.1 test.dom altsrv1 A 192.168.100.251 -Uadministrator\nsamba-tool user create sambauser1 # (2)\nsamba-tool user create sambauser1 # (3)\n</code></pre> <ol> <li>\u0447\u0435\u0440\u0435\u0437 web-gui \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0430\u0447\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u0438</li> <li>\u043f\u0430\u0440\u043e\u043b\u044c - <code>Pa$$word</code></li> <li>\u043f\u0430\u0440\u043e\u043b\u044c - <code>Pa$$word</code></li> </ol>"},{"location":"ticket_04/#etcnetifacesens19resolvconf","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 127.0.0.1\n</code></pre>"},{"location":"ticket_04/#altsrv1","title":"Altsrv1","text":""},{"location":"ticket_04/#etchosts_1","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre>"},{"location":"ticket_04/#etcnetifacesens19resolvconf_1","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre> <pre><code>hostnamectl set-hostname altsrv1.test.dom\napt-get install alterator-fbi\nsystemctl enable --now alteratord ahttpd\napt-get install alterator-net-domain task-samba-dc\napt-get install alterator-datetime\nsystemctl restart alteratord ahttpd\nsystemctl stop smb nmb krb5kdc slapd bind dnsmasq\nsystemctl disable smb nmb krb5kdc slapd bind dnsmasq\nrm -f /etc/samba/smb.conf\nrm -rf /var/lib/samba\nrm -rf /var/cache/samba\nmkdir -p /var/lib/samba/sysvol\nvim /etc/krb5.conf # (1)\nsamba-tool domain join test.dom DC -Uadministrator --realm=test.dom\nsystemctl enable samba\n\n# (2)\nhost test.dom\nsamba-tool computer list\nsamba-tool user list\n</code></pre> <ol> <li>\u0432\u043d\u043e\u0441\u0438\u043c \u043f\u0440\u0430\u0432\u043a\u0438</li> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430</li> </ol>"},{"location":"ticket_04/#etckrb5conf","title":"/etc/krb5.conf","text":"<p><pre><code>[libdefaults]\n dns_lookup_kdc = true\n dns_lookup_realm = false\n ...\n default_realm = TEST.DOM\n ...\n</code></pre> </p>"},{"location":"ticket_04/#altwks1","title":"Altwks1","text":""},{"location":"ticket_04/#etchosts_2","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre>"},{"location":"ticket_04/#etcnetifacesens19resolvconf_2","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre> <pre><code>hostnamectl set-hostname altswks1.test.dom\nvim /etc/net/ifaces/ens19/resolv.conf\nreboot\n\n# (1)\napt-get install task-auth-ad-sssd\n</code></pre> <ol> <li>\u0432\u0432\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d</li> </ol>"},{"location":"ticket_05/","title":"\u0411\u0438\u043b\u0435\u0442 05. \u0414\u043e\u043c\u0435\u043d AD \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0442\u0440\u0430\u0444\u0438\u043a\u0430","text":""},{"location":"ticket_05/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0434\u043e\u043c\u0435\u043d\u0430 AD - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_05/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0434\u043e\u043c\u0435\u043d Active Directory \u0441 \u0438\u043c\u0435\u043d\u0435\u043c test.dom</li> <li>\u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b</li> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417: sambauser1 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>, sambauser2 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>,</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0443 \u0434\u043e\u043c\u0435\u043d\u0430 \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430\u043c SSH, DNS, LDAP, SMB, Kerberos, NTP \u0441 \u0443\u0437\u043b\u043e\u0432 \u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u044e\u0442 \u043b\u044e\u0431\u044b\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043a\u0440\u043e\u043c\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445</li> </ul> </li> </ul>"},{"location":"ticket_05/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430<ul> <li>\u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043f\u043e\u0434 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0439 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0439 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u044c\u044e</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430<ul> <li>\u0443\u0442\u0438\u043b\u0438\u0442\u043e\u0439 nmap \u043a \u043b\u044e\u0431\u043e\u043c\u0443 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043f\u043e\u0440\u0442\u0443 - \u043f\u043e\u0440\u0442\u044b \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u0432, \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u0430 \u0434\u043e\u043c\u0435\u043d\u0430</li> </ul>"},{"location":"ticket_05/#altsrv2","title":"Altsrv2","text":""},{"location":"ticket_05/#etchosts","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altsrv2.test.dom\napt-get install alterator-fbi\nsystemctl enable --now alteratord ahttpd\napt-get install alterator-net-domain task-samba-dc\napt-get install alterator-datetime # (1)\nsystemctl restart alteratord ahttpd\nsystemctl stop smb nmb krb5kdc slapd bind dnsmasq\nsystemctl disable smb nmb krb5kdc slapd bind dnsmasq\nrm -f /etc/samba/smb.conf\nrm -rf /var/lib/samba\nrm -rf /var/cache/samba\nmkdir -p /var/lib/samba/sysvol\nsamba-tool domain provision --realm=test.dom --domain test --adminpass='Pa$$word' --dns-backend=SAMBA_INTERNAL --server-role=dc --use-rfc2307\nsystemctl enable --now samba\ncp /var/lib/samba/private/krb5.conf /etc/krb5.conf\nsamba-tool user create sambauser1 # (2)\nsamba-tool user create sambauser2 # (3)\n</code></pre> <ol> <li>\u0447\u0435\u0440\u0435\u0437 web-gui \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u0434\u0430\u0447\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u0438</li> <li>\u043f\u0430\u0440\u043e\u043b\u044c - <code>Pa$$word</code></li> <li>\u043f\u0430\u0440\u043e\u043b\u044c - <code>Pa$$word</code></li> </ol>"},{"location":"ticket_05/#etcnetifacesens19resolvconf","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 127.0.0.1\n</code></pre>"},{"location":"ticket_05/#iptables","title":"iptables","text":"<pre><code>#!/bin/bash\n\n# \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043f\u0440\u0430\u0432\u0438\u043b\niptables -F\niptables -X\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P OUTPUT ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c DNS\niptables -A INPUT -p udp --dport 53 -j ACCEPT # \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430\niptables -A INPUT -p udp --sport 53 -j ACCEPT # \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\niptables -A INPUT -p tcp --sport 80 -j ACCEPT\niptables -A INPUT -p tcp --sport 443 -j ACCEPT\n\niptables -A INPUT -p tcp --dport 22 -j ACCEPT # SSH\niptables -A INPUT -p tcp --dport 88 -j ACCEPT # Kerberos\niptables -A INPUT -p udp --dport 88 -j ACCEPT # Kerberos\niptables -A INPUT -p tcp --dport 389 -j ACCEPT # LDAP\niptables -A INPUT -p udp --dport 389 -j ACCEPT # LDAP\niptables -A INPUT -p tcp --dport 636 -j ACCEPT # LDAPS\niptables -A INPUT -p udp --dport 123 -j ACCEPT # NTP\niptables -A INPUT -p tcp --dport 445 -j ACCEPT # SMB\n\n# \u0417\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P INPUT DROP\n</code></pre> <pre><code>iptables-save &gt; /etc/sysconfig/iptables\niptables-restore /etc/sysconfig/iptables\nsystemctl enable --now iptables\n</code></pre>"},{"location":"ticket_05/#altsrv1","title":"Altsrv1","text":""},{"location":"ticket_05/#etchosts_1","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altsrv1.test.dom\nvim /etc/net/ifaces/ens19/resolv.conf\nreboot\n\n# (1)\napt-get install task-auth-ad-sssd\n</code></pre> <ol> <li>\u0432\u0432\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d</li> </ol>"},{"location":"ticket_05/#etcnetifacesens19resolvconf_1","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_05/#altwks1","title":"Altwks1","text":""},{"location":"ticket_05/#etchosts_2","title":"/etc/hosts","text":"<pre><code>192.168.100.250 altwks1 altwks1.test.dom\n192.168.100.251 altsrv1 altsrv1.test.dom\n192.168.100.252 altsrv2 altsrv2.test.dom\n</code></pre> <pre><code>hostnamectl set-hostname altwks1.test.dom\nvim /etc/net/ifaces/ens19/resolv.conf\nreboot\n\n# (1)\napt-get install task-auth-ad-sssd\n</code></pre> <ol> <li>\u0432\u0432\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d</li> </ol>"},{"location":"ticket_05/#etcnetifacesens19resolvconf_2","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_06/","title":"\u0411\u0438\u043b\u0435\u0442 06. \u041f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0435\u0439 \u0438  \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0442\u0440\u0430\u0444\u0438\u043a\u0430","text":""},{"location":"ticket_06/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 (\u043f\u0440\u043e\u043a\u0441\u0438 SQUID) - \u043b\u0438\u0431\u043e \u043d\u0430 altsrv2 \u043b\u0438\u0431\u043e \u043d\u0430 astra2</li> </ol>"},{"location":"ticket_06/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 - \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u0439 SQUID \u0432 \u043d\u0435\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u043e\u0440\u0442\u0430 3128 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432</li> <li>\u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f \u043d\u0430 SQUID \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043f\u043e \u043c\u0435\u0442\u043e\u0434\u0443 BASIC \u0438\u043b\u0438 DIGEST</li> <li>\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0434\u043b\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438: proxyuser1 - \u043f\u0430\u0440\u043e\u043b\u044c netlab123, proxyuser2 - \u043f\u0430\u0440\u043e\u043b\u044c netlab123</li> <li>\u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0430 \u0440\u0430\u0431\u043e\u0442\u0443 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u043a\u0441\u0438 \u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0435</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0441 \u0443\u0437\u043b\u043e\u0432 \u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u044e\u0442 \u043b\u044e\u0431\u044b\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043a\u0440\u043e\u043c\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0448\u0435</li> </ul> </li> </ul>"},{"location":"ticket_06/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430<ul> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430\u043c HTTP/HTTPS \u043f\u0440\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430 \u043d\u0430 proxy-\u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438</li> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0431\u0435\u0437 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438 \u0441\u0435\u0440\u0432\u0435\u0440</li> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u043f\u0440\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0438 \u0423\u0417/\u043f\u0430\u0440\u043e\u043b\u0435\u0439, \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0445 \u043e\u0442: proxyuser1 - \u043f\u0430\u0440\u043e\u043b\u044c netlab123, proxyuser2 - \u043f\u0430\u0440\u043e\u043b\u044c netlab123</li> <li>\u0443\u0442\u0438\u043b\u0438\u0442\u043e\u0439 nmap - \u043f\u043e\u0440\u0442\u044b \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u0432, \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043d\u0430 \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0435</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u043f\u0440\u043e\u043a\u0441\u0438-\u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> </ul>"},{"location":"ticket_06/#altwks1","title":"Altwks1","text":"<pre><code>echo \"192.168.100.252 altsrv2\" &gt;&gt; /etc/hosts\nip r del default\nexport http_proxy=http://altsrv2:3128\nexport https_proxy=https://altsrv2:3128\napt-get install nmap\nnmap -sS altsrv2\n</code></pre>"},{"location":"ticket_06/#altsrv2","title":"Altsrv2","text":"<pre><code>apt-get install squid squid-helpers\nsystemctl enable --now squid\nvim /etc/squid/squid.conf\nsquid -k check\nsystemctl restart squid\n\n# (1)\ncd /etc/squid\ntouch passwd\nchown squid:squid passwd\napt-get install apache2-htpasswd\nhtpasswd passwd proxyuser1 # (2)\nhtpasswd passwd proxyuser2 # (3)\n</code></pre> <ol> <li>basic \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f</li> <li>\u043f\u0430\u0440\u043e\u043b\u044c netlab123</li> <li>\u043f\u0430\u0440\u043e\u043b\u044c netlab123</li> </ol>"},{"location":"ticket_06/#etcsquidsquidconf","title":"/etc/squid/squid.conf","text":"<pre><code>...\n\n# auth_param (basic)\nauth_param basic program /usr/lib/squid/basic_ncsa_auth /etc/squid/passwd\nauth_param basic children 5\nauth_param basic realm Squid Basic Authentication\nauth_param basic credentialsttl 2 hours\n\n#\n# Recommended minimum Access Permission configuration:\n#\n\n...\n\n#\n# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS\n#\n\n# For example, to allow access from your local networks, you may uncomment the\n# following rule (and/or add rules that match your definition of \"local\"):\n# http_access allow localnet\n#\nacl exam scr 192.168.100.0/24\nacl auth_users proxy_auth REQUIRED\nhttp_access allow auth_users\n#http_access allow exam\n\n...\n\n#\n# Cache settings\n#\ncache_mem 256 MB\ncache_dir ufs /var/spool/squid/ 1000 16 16\n</code></pre>"},{"location":"ticket_06/#iptables","title":"iptables","text":"<pre><code>#!/bin/bash\n\n# \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043f\u0440\u0430\u0432\u0438\u043b\niptables -F\niptables -X\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P OUTPUT ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c DNS\niptables -A INPUT -p udp --dport 53 -j ACCEPT # \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\niptables -A INPUT -p tcp --sport 80 -j ACCEPT\niptables -A INPUT -p tcp --sport 443 -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u043d\u0435\u043a\u0442\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432\niptables -A INPUT -p tcp --dport 3128 -j ACCEPT\n\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# \u0417\u0430\u043f\u0440\u0435\u0442 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e\niptables -P INPUT DROP\n</code></pre>"},{"location":"ticket_07/","title":"\u0411\u0438\u043b\u0435\u0442 07. \u041e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f FreeIPA","text":""},{"location":"ticket_07/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u041f\u0435\u0440\u0432\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 FreeIPA - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0412\u0442\u043e\u0440\u043e\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 FreeIPA - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_07/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0434\u043e\u043c\u0435\u043d FreeIPA \u0441 \u0438\u043c\u0435\u043d\u0435\u043c test.dom</li> <li>\u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 FreeIPA</li> <li>\u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b</li> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417: ipaauser1 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>, ipauser2 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>,</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0434\u043e\u043c\u0435\u043d\u0430 \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443</li> <li>\u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0435\u0441\u043b\u0438 \u043e\u0431\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 FreeIPA \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b</li> <li>\u0432 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 FreeIPA (\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u044b\u0439) \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d</li> </ul> </li> </ul>"},{"location":"ticket_07/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u043f\u043e\u0434 \u043e\u0431\u043e\u0438\u043c\u0438 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0443\u0447\u0435\u0442\u043d\u044b\u043c\u0438 \u0437\u0430\u043f\u0438\u0441\u044f\u043c\u0438<ul> <li>\u0432\u0445\u043e\u0434 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u043c \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 FreeIPA</li> <li>\u0432\u0445\u043e\u0434 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u043c \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 FreeIPA</li> </ul> </li> </ul>"},{"location":"ticket_07/#altwks1","title":"Altwks1","text":"<pre><code>echo \"192.168.100.250 altwks1.test.dom altwks1\" &gt;&gt; /etc/hosts\necho \"192.168.100.251 altsrv1.test.dom altsrv1\" &gt;&gt; /etc/hosts\necho \"192.168.100.252 altsrv2.test.dom altsrv2\" &gt;&gt; /etc/hosts\nhostnamectl set-hostname altwks1.test.dom\nreboot\napt-get install task-auth-freeipa\nvim /etc/net/ifaces/ens19/resolv.conf\n</code></pre>"},{"location":"ticket_07/#etcnetifacesens19resolvconf","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_07/#altsrv2","title":"Altsrv2","text":"<pre><code>echo \"192.168.100.250 altwks1.test.dom altwks1\" &gt;&gt; /etc/hosts\necho \"192.168.100.251 altsrv1.test.dom altsrv1\" &gt;&gt; /etc/hosts\necho \"192.168.100.252 altsrv2.test.dom altsrv2\" &gt;&gt; /etc/hosts\nhostnamectl set-hostname altsrv2.test.dom\nreboot\napt-get update\napt-get install haveged\nsystemctl enable --now haveged\n\n# (1)\nservice ahttpd stop\na2dissite 000-default_https\na2disport https\nservice httpd2 condreload\n\napt-get install freeipa-server freeipa-server-dns\nipa-server-install -U --hostname=$(hostname) -r TEST.DOM -n test.dom -p netlab123 -a netlab123 --setup-dns --no-forwarders --no-reverse\nipa dnsrecord-add test.dom _ntp._udp --srv-priority=0 --srv-weight=100 --srv-port=123 --srv-target=altsrv2.test.dom.\n</code></pre> <ol> <li>\u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0443\u044e\u0449\u0438\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> </ol> <pre><code>1. You must make sure these network ports are open:\n        TCP Ports:\n          * 80, 443: HTTP/HTTPS\n          * 389, 636: LDAP/LDAPS\n          * 88, 464: kerberos\n          * 53: bind\n        UDP Ports:\n          * 88, 464: kerberos\n          * 53: bind\n          * 123: ntp\n</code></pre>"},{"location":"ticket_07/#altsrv1","title":"Altsrv1","text":"<pre><code>echo \"192.168.100.250 altwks1.test.dom altwks1\" &gt;&gt; /etc/hosts\necho \"192.168.100.251 altsrv1.test.dom altsrv1\" &gt;&gt; /etc/hosts\necho \"192.168.100.252 altsrv2.test.dom altsrv2\" &gt;&gt; /etc/hosts\nhostnamectl set-hostname altsrv1.test.dom\nreboot\napt-get update\napt-get install haveged\nsystemctl enable --now haveged\nvim /etc/net/ifaces/ens19/resolv.conf\napt-get install freeipa-client freeipa-server-dns\n\n# (1)\nservice ahttpd stop\na2dissite 000-default_https\na2disport https\nservice httpd2 condreload\n\nipa-client-install -d --domain=test.dom --server=altsrv2.test.dom --realm=TEST.DOM --principal=admin --password=netlab123 --enable-dns-updates -U\nipa-replica-install\nipa-dns-install\nipa-ca-install\n</code></pre> <ol> <li>\u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0443\u044e\u0449\u0438\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> </ol>"},{"location":"ticket_07/#etcnetifacesens19resolvconf_1","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_08/","title":"\u0411\u0438\u043b\u0435\u0442 08. \u0414\u043e\u043c\u0435\u043d FreeIPA \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0442\u0440\u0430\u0444\u0438\u043a\u0430","text":""},{"location":"ticket_08/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 FreeIPA - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_08/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>\u0434\u043e\u043c\u0435\u043d FreeIPA \u0441 \u0438\u043c\u0435\u043d\u0435\u043c test.dom</li> <li>\u0432 \u0441\u043e\u0441\u0442\u0430\u0432 \u0434\u043e\u043c\u0435\u043d\u0430 \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b</li> <li>\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0432\u0445\u043e\u0434 \u0432 \u0434\u043e\u043c\u0435\u043d \u043f\u043e\u0434 \u0434\u043e\u043c\u0435\u043d\u043d\u044b\u043c\u0438 \u0423\u0417: ipauser1 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>, ipauser2 - \u043f\u0430\u0440\u043e\u043b\u044c <code>Pa$$word</code>,</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 FreeIPA \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043f\u043e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430\u043c HTTPS, LDAP, SMB, Kerberos, NTP \u0441 \u0443\u0437\u043b\u043e\u0432 \u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 FreeIPA \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u0437\u0430\u043f\u0440\u0435\u0449\u0430\u044e\u0442 \u043b\u044e\u0431\u044b\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043a\u0440\u043e\u043c\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445</li> </ul> </li> </ul>"},{"location":"ticket_08/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430<ul> <li>\u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0432\u0445\u043e\u0434\u0430 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043f\u043e\u0434 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0439 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u044c\u044e \u0434\u043e\u043c\u0435\u043d\u0430 IPA</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430<ul> <li>\u0443\u0442\u0438\u043b\u0438\u0442\u043e\u0439 nmap \u043a \u043b\u044e\u0431\u043e\u043c\u0443 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043f\u043e\u0440\u0442\u0443 - \u043f\u043e\u0440\u0442\u044b \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u0432, \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430 FreeIPA</li> </ul>"},{"location":"ticket_08/#altwks1","title":"Altwks1","text":"<pre><code>echo \"192.168.100.250 altwks1.test.dom altwks1\" &gt;&gt; /etc/hosts\necho \"192.168.100.252 altsrv2.test.dom altsrv2\" &gt;&gt; /etc/hosts\nhostnamectl set-hostname altwks1.test.dom\nreboot\napt-get install task-auth-freeipa\nvim /etc/net/ifaces/ens19/resolv.conf\n</code></pre>"},{"location":"ticket_08/#etcnetifacesens19resolvconf","title":"/etc/net/ifaces/ens19/resolv.conf","text":"<pre><code>search test.dom\nnameserver 192.168.100.252\n</code></pre>"},{"location":"ticket_08/#altsrv2","title":"Altsrv2","text":"<pre><code>echo \"192.168.100.250 altwks1.test.dom altwks1\" &gt;&gt; /etc/hosts\necho \"192.168.100.252 altsrv2.test.dom altsrv2\" &gt;&gt; /etc/hosts\nhostnamectl set-hostname altsrv2.test.dom\nreboot\napt-get install haveged\nsystemctl enable --now haveged\n\n# (1)\nservice ahttpd stop\na2dissite 000-default_https\na2disport https\nservice httpd2 condreload\n\napt-get install freeipa-server freeipa-server-dns\nipa-server-install -U --hostname=$(hostname) -r TEST.DOM -n test.dom -p netlab123 -a netlab123 --setup-dns --no-forwarders --no-reverse\n</code></pre> <ol> <li>\u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0443\u044e\u0449\u0438\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> </ol> <pre><code>1. You must make sure these network ports are open:\n        TCP Ports:\n          * 80, 443: HTTP/HTTPS\n          * 389, 636: LDAP/LDAPS\n          * 88, 464: kerberos\n          * 53: bind\n        UDP Ports:\n          * 88, 464: kerberos\n          * 53: bind\n          * 123: ntp\n</code></pre>"},{"location":"ticket_08/#iptablessh","title":"iptables.sh","text":"<pre><code>#!/bin/bash\n\n# \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043f\u0440\u0430\u0432\u0438\u043b\niptables -F\niptables -X\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P OUTPUT ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c DNS\niptables -A INPUT -p udp --dport 53 -j ACCEPT # \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430\niptables -A INPUT -p udp --sport 53 -j ACCEPT # \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\niptables -A INPUT -p tcp --sport 80 -j ACCEPT\niptables -A INPUT -p tcp --sport 443 -j ACCEPT\n\niptables -A INPUT -p tcp --dport 88 -j ACCEPT # Kerberos\niptables -A INPUT -p udp --dport 88 -j ACCEPT # Kerberos\niptables -A INPUT -p tcp --dport 389 -j ACCEPT # LDAP\niptables -A INPUT -p udp --dport 389 -j ACCEPT # LDAP\niptables -A INPUT -p tcp --dport 636 -j ACCEPT # LDAPS\niptables -A INPUT -p udp --dport 123 -j ACCEPT # NTP\niptables -A INPUT -p tcp --dport 445 -j ACCEPT # SMB\n\n# \u0417\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P INPUT DROP\n</code></pre>"},{"location":"ticket_09/","title":"\u0411\u0438\u043b\u0435\u0442 09. Dynamic DNS","text":""},{"location":"ticket_09/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 DHCP - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 DNS - \u043b\u044e\u0431\u0430\u044f \u0434\u0440\u0443\u0433\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_09/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>DNS-\u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0437\u043e\u043d\u043e\u0439 test.dom \u0441 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u043f\u043e \u043a\u043b\u044e\u0447\u0443</li> <li>\u0437\u043e\u043d\u0430 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0430\u044f IP-\u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430 \u0441 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u043f\u043e \u043a\u043b\u044e\u0447\u0443</li> <li>DHCP-\u0441\u0435\u0440\u0432\u0435\u0440, \u0432\u044b\u0434\u0430\u044e\u0449\u0438\u0439 \u0430\u0434\u0440\u0435\u0441\u0430 \u0438\u0437 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u0430 IPv4-\u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430 (\u043d\u0435 \u043c\u0435\u043d\u0435\u0435 100 \u0432\u044b\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0445 \u0430\u0434\u0440\u0435\u0441\u043e\u0432) \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u044f\u043c\u043e\u0439 \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0437\u043e\u043d\u044b</li> <li>\u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 IPv4-\u0430\u0434\u0440\u0435\u0441\u0430 \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0441\u0442\u0435\u043a\u0430 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u0432</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u0435\u0438\u0445 \u0437\u043e\u043d DNS \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u043f\u0440\u0435\u0434\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u043b\u044e\u0447\u0430</li> <li>DHCP-\u0441\u0435\u0440\u0432\u0435\u0440 \u0432\u044b\u0434\u0430\u0435\u0442 \u0430\u0434\u0440\u0435\u0441\u0430 \u043d\u0435 \u043f\u0435\u0440\u0435\u0441\u0435\u043a\u0430\u044e\u0449\u0438\u0435\u0441\u044f \u0441\u043e \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0430\u0434\u0440\u0435\u0441\u0430\u043c\u0438 \u0443\u0437\u043b\u043e\u0432 \u0441\u0442\u0435\u043d\u0434\u0430</li> <li>DNS-\u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0440\u0435\u043a\u0443\u0440\u0441\u0438\u0432\u043d\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u0441 IP-\u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430</li> </ul> </li> </ul>"},{"location":"ticket_09/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430<ul> <li>\u041d\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u043e\u043d\u044b \u0431\u0435\u0437 \u043f\u0440\u0435\u0434\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043b\u044e\u0447\u0430</li> <li>\u0423\u0437\u0435\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0430\u0434\u0440\u0435\u0441\u0430, \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0430\u0434\u0440\u0435\u0441 \u0438\u0437 \u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u0441\u043e\u0437\u0434\u0430\u044e\u0442\u0441\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u043f\u0440\u044f\u043c\u044b\u0445 \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u044b\u0445 \u0437\u043e\u043d\u0430\u0445 DNS</li> </ul> </li> </ul> <p>Warning</p> <p>\u0412 \u044d\u0442\u043e\u043c \u0431\u0438\u043b\u0435\u0442\u0435 \u044f \u0437\u0430\u0431\u044b\u043b \u043f\u0440\u043e \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0437\u043e\u043d\u0443 \u0438 \u0443\u0436\u0435 \u0432\u0440\u044f\u0434 \u043b\u0438 \u043d\u0430\u0439\u0434\u0443 \u0432\u0440\u0435\u043c\u044f \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0438 \u043f\u043e\u0442\u0435\u0441\u0442\u0438\u0442\u044c. \u041c\u043e\u0436\u0435\u0442\u0435 \u043e\u0442\u043a\u0440\u044b\u0442\u044c issue</p> <p></p>"},{"location":"ticket_09/#altsrv2","title":"Altsrv2","text":"<pre><code>apt-get install bind bind-utils\ncd /var/lib/bind\nmkdir zone/ddns\nchown named:named zone/ddns\ntouch zone/ddns/test.dom.zone\nchown named:named zone/ddns/test.dom.zone\nvim chown named:named zone/ddns/test.dom.zone\n\ntsig-keygen -a HMAC-SHA512 ddns-key &gt; etc/ddns.key\nvim etc/local.conf\nnamed-checkconf -p\nnamed-checkzone test.dom zone/ddns/test.dom.zone\ncat etc/ddns.key # (1)\nvim /var/lib/bind/etc/options.conf\n</code></pre> <ol> <li>\u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438 \u0432\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043d\u0430 altsrv1</li> </ol>"},{"location":"ticket_09/#varlibbindzoneddnstestdomzone","title":"/var/lib/bind/zone/ddns/test.dom.zone","text":"<pre><code>$TTL 2h\n@       IN      SOA     test.dom        root.test.dom. (\n        2025032801\n        12h\n        2h\n        2d\n        2h )\n        IN      NS      altsrv2\naltsrv2 IN      A       192.168.100.252\n</code></pre>"},{"location":"ticket_09/#etclocalconf","title":"etc/local.conf","text":"<pre><code>include \"/etc/bind/rfc1912.conf\";\n\n// Consider adding the 1918 zones here,\n// if they are not used in your organization.\n//      include \"/etc/bind/rfc1918.conf\";\n\n// Add other zones here\ninclude \"/etc/bind/ddns.key\";\nzone \"test.dom\" {\n        type master;\n        file \"ddns/test.dom.zone\";\n        allow-update { key ddns-key; };\n};\n</code></pre>"},{"location":"ticket_09/#varlibbindetcoptionsconf","title":"/var/lib/bind/etc/options.conf","text":"<pre><code>acl goodhosts {\n    localnets;\n    localhost;\n    192.168.100.0/24;\n    };\noptions {\n    version \"unknown\";\n    directory \"/etc/bind/zone\";\n    dump-file \"/var/run/named/named_dump.db\";\n    statistics-file \"/var/run/named/named.stats\";\n    recursing-file \"/var/run/named/named.recursing\";\n    secroots-file \"/var/run/named/named.secroots\";\n\n    // disables the use of a PID file\n    pid-file none;\n\n    /*\n     * Oftenly used directives are listed below.\n     */\n\n    listen-on { localhost; 192.168.100.252; };\n    listen-on-v6 { ::1; };\n\n    /*\n     * If the forward directive is set to \"only\", the server will only\n     * query the forwarders.\n     */\n    forward only;\n    forwarders { 77.88.8.8; };\n\n    /*\n     * Specifies which hosts are allowed to ask ordinary questions.\n     */\n    //allow-query { localnets; };\n\n    /*\n     * This lets \"allow-query\" be used to specify the default zone access\n     * level rather than having to have every zone override the global\n     * value. \"allow-query-cache\" can be set at both the options and view\n     * levels.  If \"allow-query-cache\" is not set then \"allow-recursion\" is\n     * used if set, otherwise \"allow-query\" is used if set unless\n     * \"recursion no;\" is set in which case \"none;\" is used, otherwise the\n     * default (localhost; localnets;) is used.\n     */\n    //allow-query-cache { localnets; };\n\n    /*\n     * Specifies which hosts are allowed to make recursive queries\n     * through this server.  If not specified, the default is to allow\n     * recursive queries from all hosts.  Note that disallowing recursive\n     * queries for a host does not prevent the host from retrieving data\n     * that is already in the server's cache.\n     */\n    allow-recursion { goodhosts; };\n\n    /*\n     * Sets the maximum time for which the server will cache ordinary\n     * (positive) answers.  The default is one week (7 days).\n     */\n    //max-cache-ttl 86400;\n\n    /*\n     * The server will scan the network interface list every\n     * interface-interval minutes.  The default is 60 minutes.\n     * If set to 0, interface scanning will only occur when the\n     * configuration file is loaded.  After the scan, listeners will\n     * be started on any new interfaces (provided they are allowed by\n     * the listen-on configuration).  Listeners on interfaces that\n     * have gone away will be cleaned up.\n     */\n    //interface-interval 0;\n};\n\nlogging {\n    // The default_debug channel has the special property that it only\n    // produces output when the server\u2019s debug level is non-zero. It\n    // normally writes to a file called named.run in the server\u2019s working\n    // directory.\n\n    // For security reasons, when the -u command-line option is used, the\n    // named.run file is created only after named has changed to the new\n    // UID, and any debug output generated while named is starting - and\n    // still running as root - is discarded. To capture this output, run\n    // the server with the -L option to specify a default logfile, or the\n    // -g option to log to standard error which can be redirected to a\n    // file.\n\n    // channel default_debug {\n    //  file \"/var/log/named/named.run\" versions 10 size 20m;\n    //  print-time yes;\n    //  print-category yes;\n    //  print-severity yes;\n    //  severity dynamic;\n    // };\n};\n</code></pre>"},{"location":"ticket_09/#altsrv1","title":"Altsrv1","text":"<pre><code>apt-get install dhcp-server\ncd /etc/dhcp/\ncp dhcpd.conf.sample dhcpd.conf\nvim ddns.key # (1)\nvim dhcpd.conf\ndhcpd -t\nsystemctl restart dhcpd\n</code></pre> <ol> <li>\u0432\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 \u0441 altsrv2</li> </ol>"},{"location":"ticket_09/#etcdhcpdhcpdconf","title":"/etc/dhcp/dhcpd.conf","text":"<pre><code># See dhcpd.conf(5) for further configuration\n\nddns-updates on;\nddns-update-style interim;\n\ninclude \"/etc/dhcp/ddns.key\";\n\nzone test.dom {\n    primary 192.168.100.252;\n    key ddns-key;\n}\n\nzone 100.168.192.in-addr.arpa. {\n    primary 192.168.100.252;\n    key ddns-key;\n}\n\nsubnet 192.168.100.0 netmask 255.255.255.0 {\n    option routers          192.168.100.253;\n    option subnet-mask      255.255.255.0;\n\n    option nis-domain       \"test.dom\";\n    option domain-name      \"test.dom\";\n    option domain-name-servers  192.168.100.252;\n\n    range dynamic-bootp 192.168.100.100 192.168.100.200;\n    default-lease-time 21600;\n    max-lease-time 43200;\n}\n</code></pre>"},{"location":"ticket_09/#altwks1","title":"Altwks1","text":"<p> <pre><code># (1)\ndig @192.168.100.252 test.dom AXFR\n</code></pre></p> <ol> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430</li> </ol>"},{"location":"ticket_10/","title":"\u0411\u0438\u043b\u0435\u0442 10. DNS \u0441 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0435\u0439 \u043c\u0435\u0436\u0434\u0443 \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u043c \u0438 \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u044b\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u0441 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0442\u0440\u0430\u0444\u0438\u043a\u0430","text":""},{"location":"ticket_10/#_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0412\u041c","text":"<ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 DNS (primary) - \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 DNS (secondary)- \u043b\u044e\u0431\u0430\u044f \u0412\u041c \u043d\u0430 \u0432\u044b\u0431\u043e\u0440</li> </ol>"},{"location":"ticket_10/#_2","title":"\u0426\u0435\u043b\u0435\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435","text":"<ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f<ul> <li>DNS-\u0441\u0435\u0440\u0432\u0435\u0440 \u0441 \u0437\u043e\u043d\u043e\u0439 test.dom (\u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u0439 \u043f\u043e \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044e \u043a \u0437\u043e\u043d\u0435) \u0438 \u0437\u043e\u043d\u043e\u0439 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0430\u044f IP-\u0441\u0435\u0442\u0438 \u0441\u0442\u0435\u043d\u0434\u0430</li> <li>DNS-\u0441\u0435\u0440\u0432\u0435\u0440, \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u044b\u0439 \u043f\u043e \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044e \u043a \u043e\u0431\u043e\u0438\u043c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u0437\u043e\u043d\u0430</li> <li>\u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u043e\u0431\u0435\u0438\u0445 \u0437\u043e\u043d \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0437\u043e\u043d \u043d\u0430 \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u043e\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0435</li> <li>\u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0443\u0437\u0435\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0438\u043c\u0435\u043d \u0447\u0435\u0440\u0435\u0437 \u043e\u0431\u0430 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430</li> </ul> </li> <li>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438<ul> <li>\u0437\u043e\u043d\u043d\u044b\u0435 \u0442\u0440\u0430\u043d\u0441\u0444\u0435\u0440\u044b \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u043c\u0435\u0436\u0434\u0443 \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u043c \u0438 \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u044b\u043c DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c\u0438, \u043d\u043e \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0441 \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 \u0441\u0442\u0435\u043d\u0434\u0430</li> <li>\u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043e\u0431\u043e\u0438\u0445 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445 \u0440\u0430\u0437\u0440\u0435\u0448\u0430\u044e\u0442 \u043f\u0440\u0438\u0435\u043c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 \u0438 \u0442\u0440\u0430\u0444\u0438\u043a \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c\u0438</li> <li>\u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u043d\u0430 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445</li> <li>\u0432\u0441\u0435 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c\u0438 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u044e\u0442\u0441\u044f</li> </ul> </li> </ul>"},{"location":"ticket_10/#_3","title":"\u041c\u0435\u0442\u043e\u0434\u0438\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438","text":"<ul> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0441\u0442\u0435\u043d\u0434\u0430, \u043a\u0440\u043e\u043c\u0435 DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432<ul> <li>\u0435\u0441\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u043a DNS-\u0441\u0435\u0440\u0432\u0435\u0440\u0443</li> <li>\u043d\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u0442\u0440\u0430\u043d\u0441\u0444\u0435\u0440 \u0437\u043e\u043d\u044b</li> <li>\u0443\u0442\u0438\u043b\u0438\u0442\u043e\u0439 nmap \u043a \u043b\u044e\u0431\u043e\u043c\u0443 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043f\u043e\u0440\u0442\u0443 - \u043f\u043e\u0440\u0442\u044b \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u043e\u0432, \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0432 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u0445 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b</li> </ul> </li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 DNS </li> </ul>"},{"location":"ticket_10/#altsrv2","title":"Altsrv2","text":"<pre><code>apt-get install bind bind-utils\ncd /var/lib/bind\ntouch zone/test.dom.zone\ntouch zone/192-168.100.zone\nchown named:named zone/test.dom.zone\nchown named:named zone/192-168.100.zone\nvim zone/test.dom.zone\nvim zone/192-168.100.zone\nnamed-checkzone 100.168.192.in-addr.arpa zone/192-168.100.zone\nnamed-checkzone test.dom zone/test.dom.zone\nvim etc/local.conf\nvim etc/options.conf\nnamed-checkconf -p\n</code></pre>"},{"location":"ticket_10/#varlibbindzonetestdomzone","title":"/var/lib/bind/zone/test.dom.zone","text":"<pre><code>$TTL 2h\n@       IN      SOA     test.dom        root.test.dom. (\n        2025032801\n        12h\n        2h\n        2d\n        2h )\n        IN      NS      altsrv2\n        IN      NS      altsrv1\naltsrv2 IN      A       192.168.100.252\naltwks1 IN      A       192.168.100.250\naltsrv1 IN      A       192.168.100.251\n@       IN      A       192.168.100.252\n</code></pre>"},{"location":"ticket_10/#varlibbindzone192-168100zone","title":"/var/lib/bind/zone/192-168.100.zone","text":"<pre><code>$TTL 2h\n100.168.192.in-addr.arpa.   IN  SOA altsrv2.test.dom.   root.test.dom. (\n    2025032801\n    10800\n    1800\n    3600000\n    259200 )\n    IN  NS  altsrv2.test.dom.\n252 IN  PTR altsrv2.test.dom.\n250 IN  PTR altwks1.test.dom.\n251 IN  PTR altsrv1.test.dom.\n</code></pre>"},{"location":"ticket_10/#etclocalconf","title":"etc/local.conf","text":"<pre><code>include \"/etc/bind/rfc1912.conf\";\n\n// Consider adding the 1918 zones here,\n// if they are not used in your organization.\n//      include \"/etc/bind/rfc1918.conf\";\n\n// Add other zones here\nzone \"test.dom\" {\n        type master;\n        file \"test.dom.zone\";\n};\n\nzone \"100.168.192.in-addr.arpa\" {\n        type master;\n        file \"192-168.100.zone\";\n};\n</code></pre>"},{"location":"ticket_10/#varlibbindetcoptionsconf","title":"/var/lib/bind/etc/options.conf","text":"<pre><code>acl goodhosts {\n    localnets;\n    localhost;\n    192.168.100.0/24;\n    };\noptions {\n    version \"unknown\";\n    directory \"/etc/bind/zone\";\n    dump-file \"/var/run/named/named_dump.db\";\n    statistics-file \"/var/run/named/named.stats\";\n    recursing-file \"/var/run/named/named.recursing\";\n    secroots-file \"/var/run/named/named.secroots\";\n\n    // disables the use of a PID file\n    pid-file none;\n\n    /*\n     * Oftenly used directives are listed below.\n     */\n\n    listen-on { localhost; 192.168.100.252; };\n    listen-on-v6 { ::1; };\n\n    /*\n     * If the forward directive is set to \"only\", the server will only\n     * query the forwarders.\n     */\n    forward only;\n    forwarders { 77.88.8.8; };\n\n    /*\n     * Specifies which hosts are allowed to ask ordinary questions.\n     */\n    //allow-query { localnets; };\n\n    /*\n     * This lets \"allow-query\" be used to specify the default zone access\n     * level rather than having to have every zone override the global\n     * value. \"allow-query-cache\" can be set at both the options and view\n     * levels.  If \"allow-query-cache\" is not set then \"allow-recursion\" is\n     * used if set, otherwise \"allow-query\" is used if set unless\n     * \"recursion no;\" is set in which case \"none;\" is used, otherwise the\n     * default (localhost; localnets;) is used.\n     */\n    //allow-query-cache { localnets; };\n\n    /*\n     * Specifies which hosts are allowed to make recursive queries\n     * through this server.  If not specified, the default is to allow\n     * recursive queries from all hosts.  Note that disallowing recursive\n     * queries for a host does not prevent the host from retrieving data\n     * that is already in the server's cache.\n     */\n    allow-recursion { goodhosts; };\n\n    /*\n     * Sets the maximum time for which the server will cache ordinary\n     * (positive) answers.  The default is one week (7 days).\n     */\n    //max-cache-ttl 86400;\n\n    /*\n     * The server will scan the network interface list every\n     * interface-interval minutes.  The default is 60 minutes.\n     * If set to 0, interface scanning will only occur when the\n     * configuration file is loaded.  After the scan, listeners will\n     * be started on any new interfaces (provided they are allowed by\n     * the listen-on configuration).  Listeners on interfaces that\n     * have gone away will be cleaned up.\n     */\n    //interface-interval 0;\n    allow-transfer { localhost; 192.168.100.251; };\n};\n\nlogging {\n    // The default_debug channel has the special property that it only\n    // produces output when the server\u2019s debug level is non-zero. It\n    // normally writes to a file called named.run in the server\u2019s working\n    // directory.\n\n    // For security reasons, when the -u command-line option is used, the\n    // named.run file is created only after named has changed to the new\n    // UID, and any debug output generated while named is starting - and\n    // still running as root - is discarded. To capture this output, run\n    // the server with the -L option to specify a default logfile, or the\n    // -g option to log to standard error which can be redirected to a\n    // file.\n\n    // channel default_debug {\n    //  file \"/var/log/named/named.run\" versions 10 size 20m;\n    //  print-time yes;\n    //  print-category yes;\n    //  print-severity yes;\n    //  severity dynamic;\n    // };\n};\n</code></pre>"},{"location":"ticket_10/#iptables","title":"iptables","text":"<pre><code>#!/bin/bash\n\n# \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0442\u0435\u043a\u0443\u0449\u0438\u0445 \u043f\u0440\u0430\u0432\u0438\u043b \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u043e\u043b\u0438\u0442\u0438\u043a \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\niptables -F\niptables -X\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P OUTPUT ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0442\u0440\u0430\u0444\u0438\u043a (loopback)\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 DNS-\u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 (UDP 53)\niptables -A INPUT -p udp --dport 53 -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0442\u0440\u0430\u0444\u0438\u043a \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0441\u043e \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u043e\u0433\u043e DNS (192.168.100.251)\niptables -A INPUT -p tcp --dport 53 -s 192.168.100.251 -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e (HTTP/HTTPS)\niptables -A INPUT -p tcp --dport 80 -j ACCEPT   # HTTP\niptables -A INPUT -p tcp --dport 443 -j ACCEPT  # HTTPS\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0443\u0436\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# \u0417\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435\niptables -P INPUT DROP\n</code></pre>"},{"location":"ticket_10/#altsrv1","title":"Altsrv1","text":"<pre><code>apt-get install bind bind-utils\nvim /var/lib/bind/etc/options.conf\ncd /var/lib/bind\ncontrol bind-slave enabled\nvim etc/local.conf\nnamed-checkconf -p\nrndc reload\ndig @192.168.100.251 test.dom AXFR\n</code></pre>"},{"location":"ticket_10/#varlibbindetcoptionsconf_1","title":"/var/lib/bind/etc/options.conf","text":"<pre><code>acl goodhosts {\n    localnets;\n    localhost;\n    192.168.100.0/24;\n    };\noptions {\n    version \"unknown\";\n    directory \"/etc/bind/zone\";\n    dump-file \"/var/run/named/named_dump.db\";\n    statistics-file \"/var/run/named/named.stats\";\n    recursing-file \"/var/run/named/named.recursing\";\n    secroots-file \"/var/run/named/named.secroots\";\n\n    // disables the use of a PID file\n    pid-file none;\n\n    /*\n     * Oftenly used directives are listed below.\n     */\n\n    listen-on { localhost; 192.168.100.252; };\n    listen-on-v6 { ::1; };\n\n    /*\n     * If the forward directive is set to \"only\", the server will only\n     * query the forwarders.\n     */\n    forward only;\n    forwarders { 77.88.8.8; };\n\n    /*\n     * Specifies which hosts are allowed to ask ordinary questions.\n     */\n    //allow-query { localnets; };\n\n    /*\n     * This lets \"allow-query\" be used to specify the default zone access\n     * level rather than having to have every zone override the global\n     * value. \"allow-query-cache\" can be set at both the options and view\n     * levels.  If \"allow-query-cache\" is not set then \"allow-recursion\" is\n     * used if set, otherwise \"allow-query\" is used if set unless\n     * \"recursion no;\" is set in which case \"none;\" is used, otherwise the\n     * default (localhost; localnets;) is used.\n     */\n    //allow-query-cache { localnets; };\n\n    /*\n     * Specifies which hosts are allowed to make recursive queries\n     * through this server.  If not specified, the default is to allow\n     * recursive queries from all hosts.  Note that disallowing recursive\n     * queries for a host does not prevent the host from retrieving data\n     * that is already in the server's cache.\n     */\n    allow-recursion { goodhosts; };\n\n    /*\n     * Sets the maximum time for which the server will cache ordinary\n     * (positive) answers.  The default is one week (7 days).\n     */\n    //max-cache-ttl 86400;\n\n    /*\n     * The server will scan the network interface list every\n     * interface-interval minutes.  The default is 60 minutes.\n     * If set to 0, interface scanning will only occur when the\n     * configuration file is loaded.  After the scan, listeners will\n     * be started on any new interfaces (provided they are allowed by\n     * the listen-on configuration).  Listeners on interfaces that\n     * have gone away will be cleaned up.\n     */\n    //interface-interval 0;\n    allow-transfer { localhost; };\n};\n\nlogging {\n    // The default_debug channel has the special property that it only\n    // produces output when the server\u2019s debug level is non-zero. It\n    // normally writes to a file called named.run in the server\u2019s working\n    // directory.\n\n    // For security reasons, when the -u command-line option is used, the\n    // named.run file is created only after named has changed to the new\n    // UID, and any debug output generated while named is starting - and\n    // still running as root - is discarded. To capture this output, run\n    // the server with the -L option to specify a default logfile, or the\n    // -g option to log to standard error which can be redirected to a\n    // file.\n\n    // channel default_debug {\n    //  file \"/var/log/named/named.run\" versions 10 size 20m;\n    //  print-time yes;\n    //  print-category yes;\n    //  print-severity yes;\n    //  severity dynamic;\n    // };\n};\n</code></pre>"},{"location":"ticket_10/#etclocalconf_1","title":"etc/local.conf","text":"<pre><code>include \"/etc/bind/rfc1912.conf\";\n\n// Consider adding the 1918 zones here,\n// if they are not used in your organization.\n//      include \"/etc/bind/rfc1918.conf\";\n\n// Add other zones here\nzone \"test.dom\" {\n        type slave;\n        masters { 192.168.100.252; };\n        file \"slave/test.dom.zone\";\n};\nzone \"100.168.192.in-addr.arpa\" {\n        type slave;\n    masters { 192.168.100.252; };\n        file \"slave/192-168.100.zone\";\n};\n</code></pre>"},{"location":"ticket_10/#iptables_1","title":"iptables","text":"<pre><code>#!/bin/bash\n\n# \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0442\u0435\u043a\u0443\u0449\u0438\u0445 \u043f\u0440\u0430\u0432\u0438\u043b \u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u043e\u043b\u0438\u0442\u0438\u043a \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\niptables -F\niptables -X\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u0432\u0441\u0435 \u0438\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -P OUTPUT ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0442\u0440\u0430\u0444\u0438\u043a (loopback)\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0435 DNS-\u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043e\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 (UDP 53)\niptables -A INPUT -p udp --dport 53 -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0442\u0440\u0430\u0444\u0438\u043a \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u0441\u043e \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u043e\u0433\u043e DNS (192.168.100.252)\niptables -A INPUT -p tcp --dport 53 -s 192.168.100.252 -j ACCEPT\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u041f\u041e (HTTP/HTTPS)\niptables -A INPUT -p tcp --dport 80 -j ACCEPT   # HTTP\niptables -A INPUT -p tcp --dport 443 -j ACCEPT  # HTTPS\n\n# \u0420\u0430\u0437\u0440\u0435\u0448\u0430\u0435\u043c \u0443\u0436\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# \u0417\u0430\u043f\u0440\u0435\u0449\u0430\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435\niptables -P INPUT DROP\n</code></pre>"},{"location":"ticket_10/#altwks1","title":"Altwks1","text":"<p> <pre><code>[sysadmin@altwks1 ~]$ cat /etc/resolv.conf\n# Generated by resolvconf\n# Do not edit manually, use\n# /etc/net/ifaces/&lt;interface&gt;/resolv.conf instead.\nsearch test.dom\nnameserver 192.168.100.252\nnameserver 192.168.100.251\n\n[sysadmin@altwks1 ~]$ host -t NS test.dom\ntest.dom name server altsrv2.test.dom.\ntest.dom name server altsrv1.test.dom.\n\n[sysadmin@altwks1 ~]$ host -t NS test.dom 192.168.100.251\nUsing domain server:\nName: 192.168.100.251\nAddress: 192.168.100.251#53\nAliases: \n\ntest.dom name server altsrv1.test.dom.\ntest.dom name server altsrv2.test.dom.\n\napt-get install nmap\n[root@altwks1 ~]# nmap -sS altsrv1\nStarting Nmap 7.80 ( https://nmap.org ) at 2025-03-29 14:44 MSK\nNmap scan report for altsrv1 (192.168.100.251)\nHost is up (0.00050s latency).\nNot shown: 998 filtered ports\nPORT    STATE  SERVICE\n80/tcp  closed http\n443/tcp closed https\nMAC Address: FA:E1:C3:2C:2B:9A (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 4.83 seconds\n\n[root@altwks1 ~]# nmap -sU altsrv1\nStarting Nmap 7.80 ( https://nmap.org ) at 2025-03-29 14:44 MSK\nNmap scan report for altsrv1 (192.168.100.251)\nHost is up (0.00079s latency).\nNot shown: 999 open|filtered ports\nPORT   STATE SERVICE\n53/udp open  domain\nMAC Address: FA:E1:C3:2C:2B:9A (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 18.55 sec\n</code></pre></p>"}]}